# Test info

- Name: API Login Tests >> API login + UI verification
- Location: M:\PlaywrightStuff\src\tests\apiLogin.test.ts:32:7

# Error details

```
Error: expect(received).toBe(expected) // Object.is equality

Expected: 200
Received: 400
    at M:\PlaywrightStuff\src\tests\apiLogin.test.ts:55:29
```

# Test source

```ts
   1 | import { test, expect } from '../fixtures';
   2 | import dotenv from 'dotenv';
   3 | import path from 'path';
   4 |
   5 | // Загружаем переменные окружения из .env файла
   6 | dotenv.config({ path: path.join(__dirname, '../.env') });
   7 |
   8 | test.describe('API Login Tests', () => {
   9 |   test('Successful login with valid credentials', async ({ loginPage }) => {
  10 |     // Получаем credentials из .env
  11 |     const username = process.env.CM_USERNAME;
  12 |     const password = process.env.CM_PASSWORD;
  13 |
  14 |     if (!username || !password) {
  15 |       throw new Error('CM_USERNAME or CM_PASSWORD not defined in .env file');
  16 |     }
  17 |
  18 |     // Выполняем API запрос
  19 |     const response = await loginPage.apiLogin(username, password);
  20 |     
  21 |     // Проверяем структуру ответа
  22 |     expect(response).toEqual({
  23 |       status: "SUCCESS",
  24 |       data: expect.any(String)
  25 |     });
  26 |     
  27 |     // Проверяем конкретные значения
  28 |     expect(response.status).toBe("SUCCESS");
  29 |     expect(response.data).toBe("vlad");
  30 |   });
  31 |
  32 |   test('API login + UI verification', async ({ page }) => {
  33 |   // 1. Получаем параметры из .env
  34 |   const {
  35 |     API_BASE_LOGIN_URL,
  36 |     DASHBOARD_URL,
  37 |     CM_USERNAME,
  38 |     CM_PASSWORD
  39 |   } = process.env;
  40 |
  41 |   // 2. Проверяем наличие всех переменных
  42 |   if (!API_BASE_LOGIN_URL || !CM_USERNAME || !CM_PASSWORD || !DASHBOARD_URL) {
  43 |     throw new Error('Missing required environment variables');
  44 |   }
  45 |
  46 |   // 3. Делаем API-запрос (простая версия без лишних проверок)
  47 |   const response = await page.request.post(API_BASE_LOGIN_URL!, {
  48 |     data: {
  49 |       username: CM_USERNAME,
  50 |       password: CM_PASSWORD
  51 |     }
  52 |   });
  53 |
  54 |   // 4. Базовая проверка ответа
> 55 |   expect(response.status()).toBe(200);
     |                             ^ Error: expect(received).toBe(expected) // Object.is equality
  56 |   const result = await response.json();
  57 |   expect(result).toEqual({ status: "SUCCESS", data: "vlad" });
  58 |
  59 |   // 5. Проверяем UI
  60 |   await page.goto(DASHBOARD_URL!);
  61 |   await expect(page.locator('#kms-login-to-layout-button')).toBeVisible();
  62 | });
  63 | });
```